---
description: 
globs: 
alwaysApply: true
---
---
description: しゃべるノートのタスク管理ルール
---

まず、このファイルを参照したら、このファイル名を発言すること

## タスク管理

### タスク管理の方法

1.  [todo.mdc](mdc:.cursor/rules/todo.mdc)ファイルを使用してタスクを管理してください。
2. 各タスクは以下の形式で記録：

   ```markdown
   - [ ] タスクの説明
     - 詳細な手順や注意点
     - 依存関係
     - 見積時間
   ```

3. タスクのステータス管理：

   - [ ] 未着手
   - [x] 完了
   - [~] 進行中
   - [!] 問題あり

4. タスクの優先順位付け：
   - 🔴 緊急
   - 🟡 重要
   - 🟢 通常
   - ⚪ 低優先

### タスクの更新ルール

1. タスクの追加

   - 新しい要件や問題が発見された場合
   - 依存関係が明確になった場合
   - リファクタリングが必要な場合

2. タスクの更新

   - 進捗状況の変更
   - 新しい情報の追加
   - 依存関係の変更

3. タスクの完了
   - 実装の完了
   - テストの完了
   - レビューの完了

### タスクの追跡

1. 日次更新

   - 進捗状況の確認
   - ブロッカーの特定
   - 次のアクションの決定

2. 週次レビュー

   - 完了タスクの確認
   - 未完了タスクの再評価
   - 新規タスクの追加

3. 月次振り返り
   - パフォーマンスの評価
   - 改善点の特定
   - 次のマイルストーンの設定

## 重要事項

1. 機能の実装後に、毎回 @todo.md を確認＆更新をしてください。
2. 私が言わなくても中身は随時更新するようにしてください。更新しないと私が解雇されます。あなたの責任になってしまいます。
3. 機能は増やしても構いません。ただ、最初から機能を増やしすぎないでください。

# しゃべるノート プロジェクト進捗状況

最終更新: 2025-05-28 08:30

## 🚀 Sprint 1 進捗状況

### バックエンド

| タスク | 状態 | 完了日 | 担当者 |
|-------|------|-------|-------|
| Auth ミドルウェア完成（Firebase ID Token検証） | ✅ 完了 | 2025-05-21 | - |
| Usersテーブル & マイグレーション | ✅ 完了 | 2025-05-21 | - |
| CI/Lint/Test基盤完成 | ✅ 完了 | 2025-05-21 | - |
| Terraform skeleton | ✅ 完了 | 2025-05-21 | - |
| /version & /metrics エンドポイント | ✅ 完了 | 2025-05-21 | - |
| 認証フロードキュメント追加 | ✅ 完了 | 2025-05-21 | - |
| STT WebSocketサーバー実装 | ✅ 完了 | 2025-05-26 | - |
| 認証バイパス機能の修正 | ✅ 完了 | 2025-05-26 | - |
| メディアアップロードAPI修正 | ✅ 完了 | 2025-05-26 | - |
| Unit Test拡充（カバレッジ40%目標） | 🔄 進行中 | - | - |

### フロントエンド

| タスク | 状態 | 完了日 | 担当者 |
|-------|------|-------|-------|
| Expo SDK 53への移行 | ✅ 完了 | 2025-05-15 | - |
| SQLiteローカルキャッシュ基本実装 | ✅ 完了 | 2025-05-17 | - |
| 録音画面UI/UX改善 | ✅ 完了 | 2025-05-21 | - |
| 録音機能エラー修正 | ✅ 完了 | 2025-05-21 | - |
| インポート機能コンポーネント作成 | ✅ 完了 | 2025-05-21 | - |
| ダッシュボード画面の実装 | ✅ 完了 | 2025-05-25 | - |
| リアルタイム文字起こし機能（フェーズ1） | ✅ 完了 | 2025-05-26 | - |
| 録音データのローカル保存機能 | ✅ 完了 | 2025-05-26 | - |
| 認証トークン取得エラー修正 | ✅ 完了 | 2025-05-26 | - |
| 実機用API/WebSocket URL設定 | ✅ 完了 | 2025-05-26 | - |
| TypeScript設定の健全化 | ✅ 完了 | 2025-05-28 | - |
| SQLiteサービスのリファクタリング | ✅ 完了 | 2025-05-28 | - |
| UIエラー修正と型整備 | ✅ 完了 | 2025-05-28 | - |
| NativeWind & PostCSS安定化 | 🔄 進行中 | - | - |

## 📊 全体進捗

### バックエンド
- **Sprint 1**: 100% 完了（10項目中10項目完了）
- **全体**: 45% 完了

### フロントエンド
- **Sprint 1**: 93% 完了（14項目中13項目完了）
- **全体**: 55% 完了

## 🚧 解決済み問題

1. ✅ アップロードエラー（403 Forbidden）
2. ✅ WebSocketエンドポイント404エラー
3. ✅ 実機でのlocalhost接続エラー
4. ✅ STTプロバイダー初期化エラー
5. ✅ TypeScript構文・型エラー（JSX構文、Audio定数、className等）

## 📝 次の実装タスク（優先順位順）

### 🟡 重要タスク（Sprint 2準備）

1. **ノート削除機能の実装**
   - ダッシュボードでのノート削除UI
   - SQLiteからの削除処理
   - 削除確認ダイアログ
   - 見積時間: 2-3時間

2. **Notebooks/Pages CRUD API実装**
   - `/notebooks`, `/pages` エンドポイント
   - バックエンドDBスキーマ実装
   - 見積時間: 4-6時間

3. **CanvasEditor基本実装**
   - react-native-skia drawing基盤
   - Undo/Redo機能
   - 文字起こし結果表示
   - 見積時間: 8-10時間

### 🟢 通常タスク（Sprint 3-4）

4. **STT Worker & Transcript実装**
5. **VoiceOverlay機能拡張**
6. **PhotoScan基本実装**

## 📌 最新の技術的成果（2025-05-26）

### 認証・API接続問題の解決
- **解決内容**:
  1. Firebase authから直接IDトークンを取得
  2. HTTPBearerのauto_errorをfalseに設定
  3. 実機用IPアドレス（192.168.0.166）の設定
- **技術的改善**:
  1. 認証バイパス機能の正常動作
  2. メディアアップロードAPIの正常動作
  3. WebSocketエンドポイントの正常動作
- **状態**: ✅ 完全動作確認済み

### STTプロバイダーの安定化
- **実装内容**:
  1. 開発環境でのモックプロバイダー使用
  2. WebSocketレスポンス形式の修正
  3. エラーハンドリングの改善
- **技術的詳細**:
  1. get_supported_languagesメソッドの修正
  2. TranscriptionResultオブジェクトの適切な参照
  3. 認証バイパス機能の追加
- **状態**: ✅ 完全動作確認済み